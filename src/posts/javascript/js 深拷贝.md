---
title: js æ·±æ‹·è´
date: 2020-03-19
tags:
  - js åŸºç¡€
---


# **JavaScript å¯¹è±¡æµ…æ‹·è´å’Œæ·±æ‹·è´è¯¦è§£**

åœ¨ JavaScript ä¸­ï¼Œ**æ‹·è´å¯¹è±¡**ï¼ˆæˆ–è€…è¯´â€œå¤åˆ¶å¯¹è±¡â€ï¼‰æ˜¯éå¸¸å¸¸è§çš„æ“ä½œã€‚å¯¹è±¡æ‹·è´åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼š**æµ…æ‹·è´**å’Œ**æ·±æ‹·è´**ã€‚è¿™ä¸¤è€…çš„ä¸»è¦åŒºåˆ«åœ¨äºæ˜¯å¦ä¼šå½±å“åµŒå¥—å¯¹è±¡ã€‚ç†è§£ä¸¤è€…çš„åŒºåˆ«åŠå…¶åº”ç”¨åœºæ™¯å¯¹å¼€å‘è€…æ¥è¯´è‡³å…³é‡è¦ã€‚


---

## **ğŸ“Œ 1. æµ…æ‹·è´ï¼ˆShallow Copyï¼‰**

### **å®šä¹‰ï¼š**
æµ…æ‹·è´æ˜¯åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¹¶ä¸”å°†åŸå§‹å¯¹è±¡çš„**æ‰€æœ‰é¡¶å±‚å±æ€§**å¤åˆ¶åˆ°æ–°å¯¹è±¡ä¸­ã€‚å¦‚æœå±æ€§æ˜¯åŸå§‹æ•°æ®ç±»å‹ï¼ˆå¦‚ï¼šå­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”å€¼ï¼‰ï¼Œä¼šå¤åˆ¶å…¶å€¼ï¼›å¦‚æœå±æ€§æ˜¯å¼•ç”¨ç±»å‹ï¼ˆå¦‚ï¼šå¯¹è±¡ã€æ•°ç»„ï¼‰ï¼Œåˆ™ä¼šå¤åˆ¶å¼•ç”¨ï¼Œè€Œä¸æ˜¯å¯¹è±¡æœ¬èº«ã€‚

**æµ…æ‹·è´çš„æ ¸å¿ƒç‰¹æ€§**ï¼š
- **åŸå§‹ç±»å‹**çš„å€¼ä¼šè¢«æ‹·è´ï¼›
- **å¼•ç”¨ç±»å‹**çš„å€¼åªæ˜¯å¤åˆ¶äº†å¼•ç”¨ï¼Œå¯¼è‡´åŸå¯¹è±¡å’Œæ–°å¯¹è±¡å…±äº«ç›¸åŒçš„åµŒå¥—å¯¹è±¡æˆ–æ•°ç»„ã€‚

### **æµ…æ‹·è´ç¤ºä¾‹ï¼š**

#### **1.1. ä½¿ç”¨ `Object.assign()` è¿›è¡Œæµ…æ‹·è´**
```js
const obj1 = { a: 1, b: { x: 10 } };
const obj2 = Object.assign({}, obj1);

console.log(obj2);  // { a: 1, b: { x: 10 } }

obj2.a = 2;
obj2.b.x = 20;

console.log(obj1);  // { a: 1, b: { x: 20 } }
console.log(obj2);  // { a: 2, b: { x: 20 } }
```
**è§£æï¼š**
- `Object.assign({}, obj1)` åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å¯¹è±¡ `obj2`ï¼Œå¹¶å°† `obj1` çš„é¡¶å±‚å±æ€§å¤åˆ¶ç»™å®ƒã€‚
- å½“ä¿®æ”¹ `obj2.b.x` æ—¶ï¼Œ`obj1` ä¸­çš„ `b.x` ä¹Ÿè¢«ä¿®æ”¹äº†ï¼Œå› ä¸º `b` æ˜¯å¼•ç”¨ç±»å‹ï¼Œæµ…æ‹·è´åªå¤åˆ¶äº†å¼•ç”¨ã€‚

#### **1.2. ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦è¿›è¡Œæµ…æ‹·è´**
```js
const obj1 = { a: 1, b: { x: 10 } };
const obj2 = { ...obj1 };

console.log(obj2);  // { a: 1, b: { x: 10 } }

obj2.b.x = 20;
console.log(obj1.b.x);  // 20 (å¼•ç”¨å…±äº«)
console.log(obj2.b.x);  // 20
```

### **æµ…æ‹·è´çš„å±€é™æ€§ï¼š**
- å¦‚æœå¯¹è±¡ä¸­åŒ…å«å¼•ç”¨ç±»å‹ï¼ˆå¦‚æ•°ç»„æˆ–å¯¹è±¡ï¼‰ï¼Œæµ…æ‹·è´å°†å¯¼è‡´æ–°æ—§å¯¹è±¡å…±äº«è¿™äº›å¼•ç”¨ç±»å‹çš„å†…å­˜åœ°å€ã€‚
- è¿™æ ·ï¼Œä¿®æ”¹æ–°å¯¹è±¡çš„åµŒå¥—å¯¹è±¡ä¹Ÿä¼šå½±å“åˆ°åŸå¯¹è±¡çš„åµŒå¥—å¯¹è±¡ã€‚

---

## **ğŸ“Œ 2. æ·±æ‹·è´ï¼ˆDeep Copyï¼‰**

### **å®šä¹‰ï¼š**
æ·±æ‹·è´æ˜¯åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¹¶ä¸”é€’å½’åœ°æ‹·è´åŸå§‹å¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼ŒåŒ…æ‹¬åµŒå¥—çš„å¯¹è±¡å’Œæ•°ç»„ã€‚æ·±æ‹·è´ä¼šåˆ›å»º**å…¨æ–°çš„å‰¯æœ¬**ï¼Œæ–°å¯¹è±¡ä¸åŸå¯¹è±¡æ²¡æœ‰ä»»ä½•å¼•ç”¨å…³ç³»ï¼Œå³ä½¿å±æ€§æ˜¯å¼•ç”¨ç±»å‹ï¼Œä¹Ÿä¸ä¼šå½±å“åŸå¯¹è±¡ã€‚

### **æ·±æ‹·è´çš„æ ¸å¿ƒç‰¹æ€§ï¼š**
- **åŸå§‹ç±»å‹**çš„å€¼ä¼šè¢«æ‹·è´ï¼›
- **å¼•ç”¨ç±»å‹**çš„å€¼ä¼šè¢«é€’å½’æ‹·è´ï¼ŒåŸå¯¹è±¡å’Œæ–°å¯¹è±¡å®Œå…¨ç‹¬ç«‹ã€‚

### **2.1. ä½¿ç”¨ `JSON.stringify` å’Œ `JSON.parse` å®ç°æ·±æ‹·è´**

`JSON.stringify()` å°†å¯¹è±¡è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²ï¼Œç„¶åé€šè¿‡ `JSON.parse()` é‡æ–°è§£ææˆæ–°çš„å¯¹è±¡ã€‚

```js
const obj1 = { a: 1, b: { x: 10 } };
const obj2 = JSON.parse(JSON.stringify(obj1));

obj2.b.x = 20;

console.log(obj1);  // { a: 1, b: { x: 10 } }
console.log(obj2);  // { a: 1, b: { x: 20 } }
```

#### **ä¼˜ç‚¹ï¼š**
- ç®€å•æ˜“ç”¨ï¼Œé€‚ç”¨äºå¤§å¤šæ•°æƒ…å†µã€‚

#### **ç¼ºç‚¹ï¼š**
- **æ— æ³•å¤„ç†å‡½æ•°ã€`undefined`ã€`Symbol`ã€`RegExp` ç­‰ç±»å‹**ï¼šè¿™äº›å€¼ä¼šè¢«ä¸¢å¤±æˆ–è½¬æ¢ä¸ºæ— æ•ˆå€¼ã€‚
- **æ— æ³•æ‹·è´å¯¹è±¡ä¸­çš„å¾ªç¯å¼•ç”¨**ï¼šå¦‚æœå¯¹è±¡ä¸­å­˜åœ¨å¾ªç¯å¼•ç”¨ï¼Œä¼šå¯¼è‡´ `JSON.parse()` æŠ›å‡ºé”™è¯¯ã€‚

---

### **2.2. è‡ªå®šä¹‰æ·±æ‹·è´å‡½æ•°**

æˆ‘ä»¬å¯ä»¥é€šè¿‡é€’å½’çš„æ–¹å¼æ¥å®ç°ä¸€ä¸ªæ›´å®Œå–„çš„æ·±æ‹·è´å‡½æ•°ï¼Œèƒ½å¤Ÿå¤„ç†å„ç§è¾¹ç•Œæƒ…å†µï¼Œå¦‚ `Date`ã€`RegExp` å’Œ `Map` ç­‰ã€‚

```js
function deepClone(obj, hash = new WeakMap()) {
  if (obj == null || typeof obj !== "object") return obj; // å¤„ç† null å’Œ åŸºæœ¬æ•°æ®ç±»å‹
  if (obj instanceof Date) return new Date(obj);
  if (obj instanceof RegExp) return new RegExp(obj);
  if (obj instanceof Map) return new Map([...obj].map(([k, v]) => [deepClone(k, hash), deepClone(v, hash)]));
  if (obj instanceof Set) return new Set([...obj].map(v => deepClone(v, hash)]));
  if (obj instanceof ArrayBuffer) return obj.slice(0);
  if (ArrayBuffer.isView(obj)) return new obj.constructor(obj); // å¤„ç† TypedArray

  // å¤„ç†å¾ªç¯å¼•ç”¨
  if (hash.has(obj)) return hash.get(obj);

  // ä¿æŒå¯¹è±¡çš„åŸå‹
  let instance = Object.create(Object.getPrototypeOf(obj));
  hash.set(obj, instance);

  // å¤åˆ¶æ‰€æœ‰å±æ€§ï¼ˆåŒ…æ‹¬ä¸å¯æšä¸¾å’Œ Symbolï¼‰
  const descriptors = Object.getOwnPropertyDescriptors(obj);
  for (let key of Reflect.ownKeys(descriptors)) {
    const descriptor = descriptors[key];
    if (descriptor.value) {
      descriptor.value = deepClone(descriptor.value, hash);
    }
    Object.defineProperty(instance, key, descriptor);
  }

  return instance;
}

```

ç¤ºä¾‹
```js

// ä¸‹é¢æ˜¯éªŒè¯ä»£ç 
let obj = {
  num: 0,
  str: '',
  boolean: true,
  unf: undefined,
  nul: null,
  obj: { name: 'æˆ‘æ˜¯ä¸€ä¸ªå¯¹è±¡', id: 1 },
  arr: [0, 1, 2],
  func: function () { console.log('æˆ‘æ˜¯ä¸€ä¸ªå‡½æ•°') },
  date: new Date(0),
  reg: new RegExp('/æˆ‘æ˜¯ä¸€ä¸ªæ­£åˆ™/ig'),
  [Symbol('1')]: 1,
};
Object.defineProperty(obj, 'innumerable', {
  enumerable: false, value: 'ä¸å¯æšä¸¾å±æ€§' }
);
obj = Object.create(obj, Object.getOwnPropertyDescriptors(obj))
obj.loop = obj    // è®¾ç½®loopæˆå¾ªç¯å¼•ç”¨çš„å±æ€§
let cloneObj = deepClone(obj)
cloneObj.arr.push(4)
console.log('obj', obj)
console.log('cloneObj', cloneObj)
```

#### **è‡ªå®šä¹‰æ·±æ‹·è´å‡½æ•°çš„ä¼˜ç‚¹ï¼š**
- æ”¯æŒå¤šç§ç±»å‹çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬ `Date`ã€`RegExp`ã€`Map`ã€`Set` ç­‰ã€‚
- é€’å½’å¤„ç†åµŒå¥—å¯¹è±¡ï¼Œç¡®ä¿å®Œå…¨ç‹¬ç«‹ã€‚

---

## **ğŸ“Œ 3. `JSON.stringify` ä¸ è‡ªå®šä¹‰æ·±æ‹·è´å¯¹æ¯”**

| ç‰¹æ€§                  | `JSON.stringify` + `JSON.parse`        | è‡ªå®šä¹‰æ·±æ‹·è´å‡½æ•°                  |
|----------------------|---------------------------------------|----------------------------------|
| **ç®€æ´æ€§**            | éå¸¸ç®€æ´ï¼Œæ˜“äºå®ç°                   | éœ€è¦æ‰‹åŠ¨å®ç°é€’å½’å’Œç±»å‹åˆ¤æ–­      |
| **æ”¯æŒç±»å‹**          | ä»…æ”¯æŒæ™®é€šå¯¹è±¡ã€æ•°ç»„ã€å­—ç¬¦ä¸²ã€æ•°å­—ç­‰åŸºæœ¬ç±»å‹ | æ”¯æŒæ›´å¤šç±»å‹ï¼ˆå¦‚ `Date`ã€`RegExp`ã€`Map`ã€`Set` ç­‰ï¼‰ |
| **æ€§èƒ½**              | æ€§èƒ½è¾ƒå¥½ï¼Œä½†å¯¹äºéå¸¸å¤§çš„å¯¹è±¡å¯èƒ½ä¼šæœ‰æ€§èƒ½ç“¶é¢ˆ | è‡ªå®šä¹‰æ·±æ‹·è´å¯èƒ½æ€§èƒ½ç•¥å·®ï¼Œä½†å¯ä»¥ä¼˜åŒ– |
| **å¾ªç¯å¼•ç”¨é—®é¢˜**      | æ— æ³•å¤„ç†å¾ªç¯å¼•ç”¨ï¼ŒæŠ›å‡ºé”™è¯¯           | å¯ä»¥é€šè¿‡æ‰‹åŠ¨å¤„ç†å¾ªç¯å¼•ç”¨æ¥é¿å…é—®é¢˜ |
| **é€‚ç”¨åœºæ™¯**          | ç®€å•å¯¹è±¡å’Œæ•°ç»„çš„æ‹·è´ï¼Œæ•°æ®è¾ƒç®€å•æ—¶ä½¿ç”¨  | å¤æ‚å¯¹è±¡ã€ç‰¹æ®Šç±»å‹ã€éœ€è¦å®Œå…¨æ§åˆ¶æ·±æ‹·è´æ—¶ä½¿ç”¨ |

---

## **ğŸ“Œ æ€»ç»“**

- **æµ…æ‹·è´**åªå¤åˆ¶å¯¹è±¡çš„é¡¶å±‚å±æ€§ï¼Œå¯¹äºå¼•ç”¨ç±»å‹çš„å±æ€§ï¼Œåªæ˜¯å¤åˆ¶äº†å¼•ç”¨ï¼Œå¯¼è‡´åŸå¯¹è±¡å’Œæ–°å¯¹è±¡å…±äº«åŒä¸€ä¸ªå¼•ç”¨ã€‚
- **æ·±æ‹·è´**ä¼šé€’å½’åœ°å¤åˆ¶å¯¹è±¡åŠå…¶åµŒå¥—å¯¹è±¡ï¼Œç¡®ä¿æ–°å¯¹è±¡ä¸åŸå¯¹è±¡å®Œå…¨ç‹¬ç«‹ã€‚
- **`JSON.stringify`** å’Œ **`JSON.parse`** æ˜¯ä¸€ç§å¿«é€Ÿçš„æ·±æ‹·è´æ–¹æ³•ï¼Œä½†æœ‰å±€é™æ€§ï¼Œæ— æ³•å¤„ç†å‡½æ•°ã€`undefined`ã€`Symbol`ã€`RegExp` ç­‰ç±»å‹ã€‚
- **è‡ªå®šä¹‰æ·±æ‹·è´å‡½æ•°**æä¾›äº†æ›´å¤šçš„çµæ´»æ€§ï¼Œå¯ä»¥å¤„ç†å¤šç§ç±»å‹å’Œå¾ªç¯å¼•ç”¨é—®é¢˜ã€‚

æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©é€‚åˆçš„æ‹·è´æ–¹å¼ï¼Œç¡®ä¿æ•°æ®çš„æ­£ç¡®æ€§å’Œæ€§èƒ½çš„ä¼˜åŒ–ã€‚

## 4.**`for...in` å’Œ `for...of` çš„åŒºåˆ«**

åœ¨ JavaScript ä¸­ï¼Œ`for...in` å’Œ `for...of` éƒ½å¯ä»¥ç”¨æ¥éå†æ•°æ®ï¼Œä½†å®ƒä»¬çš„é€‚ç”¨åœºæ™¯å’Œè¡Œä¸ºæœ‰æ‰€ä¸åŒã€‚ä¸‹é¢æˆ‘ä»¬è¯¦ç»†å¯¹æ¯”ä¸¤è€…çš„**ç”¨é€”ã€é€‚ç”¨æ•°æ®ç±»å‹ã€éå†æ–¹å¼**åŠ**ä½¿ç”¨ç¤ºä¾‹**ã€‚

---

## **ğŸ“Œ 1. `for...in`**
### **ä½œç”¨**
- **éå†å¯¹è±¡çš„** **å¯æšä¸¾å±æ€§**ï¼ˆåŒ…æ‹¬ç»§æ‰¿çš„å±æ€§ï¼‰ã€‚
- **éå†æ•°ç»„çš„ç´¢å¼•**ï¼ˆ`index`ï¼‰ï¼Œè€Œä¸æ˜¯æ•°ç»„çš„å€¼ã€‚

### **é€‚ç”¨äº**
âœ… **å¯¹è±¡ï¼ˆObjectï¼‰** â†’ éå†å¯¹è±¡çš„é”®åï¼ˆåŒ…æ‹¬å¯æšä¸¾çš„ç»§æ‰¿å±æ€§ï¼‰ã€‚  
âœ… **æ•°ç»„ï¼ˆArrayï¼‰** â†’ éå†ç´¢å¼•ï¼ˆä¸æ¨èï¼‰ã€‚  
âœ… **`for...in` é€‚ç”¨äºå¯¹è±¡ï¼Œä½†éå†æ•°ç»„æ—¶å­˜åœ¨æ½œåœ¨é—®é¢˜**ï¼ˆè§ä¸‹æ–‡ï¼‰ã€‚

---

### **ç¤ºä¾‹ 1ï¼šéå†å¯¹è±¡**
```js
const obj = { a: 1, b: 2, c: 3 };

for (let key in obj) {
  console.log(key, obj[key]);  
}
// è¾“å‡ºï¼š
// a 1
// b 2
// c 3
```
ğŸ”¹ **`for...in` é€‚ç”¨äºéå†å¯¹è±¡çš„å±æ€§**ã€‚

---

### **ç¤ºä¾‹ 2ï¼šéå†æ•°ç»„ï¼ˆä¸æ¨èï¼‰**
```js
const arr = [10, 20, 30];

for (let index in arr) {
  console.log(index, arr[index]);
}
// è¾“å‡ºï¼š
// 0 10
// 1 20
// 2 30
```
ğŸ”¹ **âš ï¸ é—®é¢˜**ï¼š`for...in` éå†çš„æ˜¯**ç´¢å¼•ï¼ˆ`index`ï¼‰**ï¼Œè€Œä¸æ˜¯å€¼ã€‚

---

### **ç¤ºä¾‹ 3ï¼š`for...in` éå†æ•°ç»„çš„é—®é¢˜**
```js
Array.prototype.custom = "hello";  // ç»™æ•°ç»„æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰å±æ€§

const arr = [10, 20, 30];

for (let key in arr) {
  console.log(key, arr[key]);
}
// è¾“å‡ºï¼š
// 0 10
// 1 20
// 2 30
// custom hello   âŒï¼ˆä¸æœŸæœ›çš„è¡Œä¸ºï¼‰
```
ğŸ”¹ **`for...in` å¯èƒ½ä¼šéå†åŸå‹ä¸Šçš„å±æ€§**ï¼Œä¸é€‚ç”¨äºæ•°ç»„éå†ã€‚

---

## **ğŸ“Œ 2. `for...of`**
### **ä½œç”¨**
- **éå†å¯è¿­ä»£å¯¹è±¡çš„å€¼**ï¼ˆå¦‚æ•°ç»„ã€`Map`ã€`Set`ã€`String`ã€`arguments` ç­‰ï¼‰ã€‚
- **ä¸éå†å¯¹è±¡ï¼ˆObjectï¼‰ï¼Œåªèƒ½ç”¨äºå¯è¿­ä»£æ•°æ®ç»“æ„**ã€‚

### **é€‚ç”¨äº**
âœ… **æ•°ç»„ï¼ˆArrayï¼‰** â†’ éå†å€¼ï¼ˆæ¨èï¼‰ã€‚  
âœ… **å­—ç¬¦ä¸²ï¼ˆStringï¼‰** â†’ éå†å­—ç¬¦ã€‚  
âœ… **`Map`ã€`Set`** â†’ éå†é”®å€¼å¯¹æˆ–å…ƒç´ ã€‚  
âœ… **`arguments`ã€`NodeList`** â†’ éå†ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ã€‚  

---

### **ç¤ºä¾‹ 1ï¼šéå†æ•°ç»„**
```js
const arr = [10, 20, 30];

for (let value of arr) {
  console.log(value);
}
// è¾“å‡ºï¼š
// 10
// 20
// 30
```
ğŸ”¹ **`for...of` ç›´æ¥éå†å€¼ï¼Œæ¨èç”¨äºæ•°ç»„**ã€‚

---

### **ç¤ºä¾‹ 2ï¼šéå†å­—ç¬¦ä¸²**
```js
const str = "hello";

for (let char of str) {
  console.log(char);
}
// è¾“å‡ºï¼š
// h
// e
// l
// l
// o
```
ğŸ”¹ **`for...of` é€‚ç”¨äºéå†å­—ç¬¦ä¸²çš„å­—ç¬¦**ã€‚

---

### **ç¤ºä¾‹ 3ï¼šéå† `Set`**
```js
const set = new Set([1, 2, 3]);

for (let value of set) {
  console.log(value);
}
// è¾“å‡ºï¼š
// 1
// 2
// 3
```
ğŸ”¹ **`for...of` å¯ä»¥ç”¨äº `Set` ç»“æ„ï¼Œç›´æ¥è·å–å€¼**ã€‚

---

### **ç¤ºä¾‹ 4ï¼šéå† `Map`**
```js
const map = new Map([
  ["a", 1],
  ["b", 2],
  ["c", 3]
]);

// éå†é”®å€¼å¯¹
for (let [key, value] of map) {
  console.log(key, value);
}
// è¾“å‡ºï¼š
// a 1
// b 2
// c 3
```
ğŸ”¹ **`for...of` å¯ä»¥ç”¨äº `Map`ï¼Œç›´æ¥è§£æ„ `key-value` å¯¹**ã€‚

---

### **ç¤ºä¾‹ 5ï¼š`for...of` ä¸èƒ½éå†æ™®é€šå¯¹è±¡**
```js
const obj = { a: 1, b: 2, c: 3 };

// âŒ æŠ¥é”™ï¼šTypeError: obj is not iterable
for (let value of obj) {
  console.log(value);
}
```
ğŸ”¹ **å¯¹è±¡ `Object` ä¸æ˜¯å¯è¿­ä»£å¯¹è±¡ï¼ˆIterableï¼‰ï¼Œä¸èƒ½ç”¨ `for...of` éå†**ã€‚

å¦‚æœæƒ³è®©å¯¹è±¡æ”¯æŒ `for...of`ï¼Œéœ€è¦å®ç° **`Symbol.iterator`**ï¼š
```js
const obj = {
  a: 1, b: 2, c: 3,
  [Symbol.iterator]() {
    return Object.values(this)[Symbol.iterator]();
  }
};

for (let value of obj) {
  console.log(value);
}
// è¾“å‡ºï¼š
// 1
// 2
// 3
```
ğŸ”¹ **è¿™æ ·å¯¹è±¡å°±å˜æˆå¯è¿­ä»£å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨ `for...of` äº†**ã€‚

---

## **ğŸ“Œ 3. `for...in` vs `for...of` å¯¹æ¯”æ€»ç»“**

| æ¯”è¾ƒé¡¹         | `for...in` | `for...of` |
|--------------|-----------|-----------|
| **é€‚ç”¨äº** | **å¯¹è±¡ï¼ˆObjectï¼‰**ï¼ˆå¯æšä¸¾å±æ€§ï¼‰ | **æ•°ç»„ï¼ˆArrayï¼‰ã€å­—ç¬¦ä¸²ï¼ˆStringï¼‰ã€`Map`ã€`Set` ç­‰å¯è¿­ä»£å¯¹è±¡** |
| **éå†å†…å®¹** | **å¯¹è±¡çš„é”®åï¼ˆå­—ç¬¦ä¸²ï¼‰** æˆ– **æ•°ç»„ç´¢å¼•** | **æ•°ç»„ã€å­—ç¬¦ä¸²ç­‰å¯è¿­ä»£å¯¹è±¡çš„å€¼** |
| **èƒ½å¦éå†å¯¹è±¡** | âœ… **å¯ä»¥**ï¼ˆé”®åï¼‰ | âŒ **ä¸èƒ½**ï¼ˆé™¤éå¯¹è±¡å®ç° `Symbol.iterator`ï¼‰ |
| **èƒ½å¦éå†æ•°ç»„** | âŒ **ä¸æ¨è**ï¼ˆéå†ç´¢å¼•ï¼Œä¸éå†å€¼ï¼‰ | âœ… **æ¨è**ï¼ˆéå†å€¼ï¼‰ |
| **ä¼šéå†åŸå‹ä¸Šçš„å±æ€§** | âœ… **ä¼š**ï¼ˆéœ€è¦ `hasOwnProperty` è¿‡æ»¤ï¼‰ | âŒ **ä¸ä¼š** |
| **é€‚ç”¨äº `Map`ã€`Set`** | âŒ **ä¸é€‚ç”¨** | âœ… **é€‚ç”¨** |
| **é€‚ç”¨äºå­—ç¬¦ä¸²** | âŒ **ä¸é€‚ç”¨** | âœ… **é€‚ç”¨**ï¼ˆéå†å­—ç¬¦ï¼‰ |

---

## **ğŸ“Œ 4. ä½•æ—¶ä½¿ç”¨ `for...in` vs `for...of`ï¼Ÿ**

âœ… **ä½¿ç”¨ `for...in`ï¼š**
- é€‚ç”¨äºéå†**å¯¹è±¡çš„é”®å**ï¼ˆå¦‚ `Object.keys()`ï¼‰ã€‚
- ä½†éœ€è¦**é¿å…éå†åŸå‹é“¾ä¸Šçš„å±æ€§**ï¼Œå»ºè®®ä½¿ç”¨ `hasOwnProperty()` è¿‡æ»¤ï¼š
  ```js
  for (let key in obj) {
    if (obj.hasOwnProperty(key)) {
      console.log(key, obj[key]);
    }
  }
  ```

âœ… **ä½¿ç”¨ `for...of`ï¼š**
- é€‚ç”¨äºéå†**æ•°ç»„ã€å­—ç¬¦ä¸²ã€`Set`ã€`Map`** ç­‰å¯è¿­ä»£å¯¹è±¡ï¼Œæ¨èä½¿ç”¨ï¼š
  ```js
  for (let value of arr) {
    console.log(value);
  }
  ```

ğŸš€ **æœ€ä½³å®è·µ**ï¼š
- **éå†å¯¹è±¡ç”¨ `for...in`**
- **éå†æ•°ç»„å’Œå¯è¿­ä»£å¯¹è±¡ç”¨ `for...of`**  
- **éå†å¯¹è±¡å±æ€§æ—¶ï¼Œå»ºè®®ä½¿ç”¨ `Object.keys()`ã€`Object.values()`ã€`Object.entries()`**

è¿™æ ·å¯ä»¥å†™å‡ºæ›´æ¸…æ™°ã€æ›´é«˜æ•ˆçš„ä»£ç ï¼ğŸ¯

## 5. JSON.stringify() çš„å®ç°
```js
function myStringify(value, seen = new WeakSet()) {
  // 1ï¸âƒ£ å¤„ç† `null` å’ŒåŸºæœ¬æ•°æ®ç±»å‹ï¼ˆå­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”å€¼ã€undefinedï¼‰
  if (value === null) return 'null';
  if (typeof value === 'undefined') return undefined;
  if (typeof value === 'string') return `"${value}"`;
  if (typeof value === 'number' || typeof value === 'boolean') return String(value);

  // 2ï¸âƒ£ å¤„ç†æ•°ç»„
  if (Array.isArray(value)) {
    // ä½¿ç”¨ `.map()` éå†æ•°ç»„å¹¶æ·±åº¦è½¬æ¢æ¯ä¸€é¡¹
    const elements = value.map(item => myStringify(item, seen));
    return `[${elements.join(',')}]`;
  }

  // 3ï¸âƒ£ å¤„ç†å¯¹è±¡ï¼ˆæ’é™¤ nullï¼‰
  if (typeof value === 'object') {
    // å¤„ç†å¾ªç¯å¼•ç”¨
    if (seen.has(value)) return '{}';  // å¦‚æœå¯¹è±¡å·²ç»åœ¨ `seen` ä¸­ï¼Œé¿å…å¾ªç¯å¼•ç”¨
    seen.add(value);

    // è·å–å¯¹è±¡çš„å±æ€§å¹¶é€’å½’è½¬æ¢
    const keys = Object.keys(value);
    const properties = keys.map(key => {
      const keyStr = `"${key}"`;
      const valueStr = myStringify(value[key], seen);
      return valueStr !== undefined ? `${keyStr}:${valueStr}` : undefined;
    }).filter(item => item !== undefined);

    return `{${properties.join(',')}}`;
  }

  // å¤„ç†å…¶ä»–ç±»å‹ï¼ˆå¦‚ `function`ï¼Œå¿½ç•¥ï¼‰
  return undefined;
}

const obj = {
  name: "Alice",
  age: 30,
  friends: ["Bob", "Charlie"],
  greet: function() { console.log("Hello!"); }
};

const circularObj = { name: "John" };
circularObj.self = circularObj;

console.log(myStringify(obj));  // {"name":"Alice","age":30,"friends":["Bob","Charlie"]}
console.log(myStringify(circularObj));  // {}


```