---
title: å¸¸è§é—®é¢˜
date: 2019-08-04
tags:
   - é¢è¯•é¢˜
---

## MVC å’Œ MVVM åŒºåˆ«
MVCï¼ˆModel-View-Controllerï¼‰å’Œ MVVMï¼ˆModel-View-ViewModelï¼‰æ˜¯ä¸¤ç§å¸¸è§çš„è½¯ä»¶æ¶æ„æ¨¡å¼ï¼Œå¹¿æ³›ç”¨äºå‰ç«¯å’Œåç«¯å¼€å‘ä¸­ï¼Œå°¤å…¶æ˜¯åœ¨ UI é€»è¾‘ç»“æ„æ¸…æ™°ã€å¯ç»´æŠ¤æ€§å¼ºçš„é¡¹ç›®ä¸­ã€‚

ä¸‹é¢æ˜¯å®ƒä»¬çš„**æ ¸å¿ƒåŒºåˆ«ä¸è”ç³»**æ€»ç»“ï¼š

---

## ğŸ”· 1. æ¶æ„è§’è‰²å¯¹æ¯”

| æ¶æ„       | ç»„æˆéƒ¨åˆ†           | èŒè´£æè¿°                                |
| -------- | -------------- | ----------------------------------- |
| **MVC**  | **Model**      | ä¸šåŠ¡é€»è¾‘ã€æ•°æ®ç®¡ç†ï¼ˆå¦‚çŠ¶æ€ã€æ•°æ®ç»“æ„ã€æ•°æ®åº“æ“ä½œï¼‰           |
|          | **View**       | ç”¨æˆ·ç•Œé¢ï¼ˆHTML/CSSã€å±•ç¤ºéƒ¨åˆ†ï¼‰                 |
|          | **Controller** | æ¥æ”¶ç”¨æˆ·è¾“å…¥ï¼Œè°ƒç”¨ Model å’Œæ›´æ–° View            |
| **MVVM** | **Model**      | åŒä¸Šï¼Œæ•°æ®å±‚                              |
|          | **View**       | åŒä¸Šï¼Œå±•ç¤ºå±‚                              |
|          | **ViewModel**  | è¿æ¥ View å’Œ Modelï¼Œå°è£… UI çŠ¶æ€ã€è¡Œä¸ºï¼Œå¹¶æä¾›æ•°æ®ç»‘å®š |

---

## ğŸ”· 2. æ•°æ®ç»‘å®š

| å¯¹æ¯”ç‚¹    | MVC                             | MVVM                           |
| ------ | ------------------------------- | ------------------------------ |
| æ•°æ®ç»‘å®š   | éœ€è¦**æ‰‹åŠ¨**æ“ä½œ DOM æ›´æ–° View          | é€šè¿‡ **åŒå‘æ•°æ®ç»‘å®š** è‡ªåŠ¨æ›´æ–°             |
| æ§åˆ¶æ–¹å¼   | View <--> Controller <--> Model | View <--> ViewModel <--> Model |
| é€‚ç”¨åœºæ™¯   | æ¯”è¾ƒé€‚åˆ Web åº”ç”¨/åç«¯ MVC æ¡†æ¶           | é€‚åˆå‰ç«¯æ¡†æ¶å¦‚ Vueã€Knockoutã€Angular   |
| DOM æ“ä½œ | å¤šç”±å¼€å‘è€…æ‰‹åŠ¨å®Œæˆ                       | è‡ªåŠ¨ç»‘å®šï¼Œå‡å°‘ DOM æ“ä½œ                 |

---

## ğŸ”· 3. å·¥ä½œæµç¨‹å›¾å¯¹æ¯”

### ğŸ§© MVC æ•°æ®æµï¼š

```
ç”¨æˆ·æ“ä½œ â†’ Controller â†’ Modelï¼ˆæ›´æ–°æ•°æ®ï¼‰ â†’ Viewï¼ˆé‡æ–°æ¸²æŸ“ï¼‰
```

### ğŸ§© MVVM æ•°æ®æµï¼ˆè‡ªåŠ¨ç»‘å®šï¼‰ï¼š

```
ç”¨æˆ·æ“ä½œ â†’ View â†’ ViewModelï¼ˆå“åº”æ•°æ®å˜åŒ–ï¼‰ â†” Model
             â†‘
             â†“ï¼ˆViewModel æ•°æ®å˜åŒ–è‡ªåŠ¨æ›´æ–° Viewï¼‰
```

---

## ğŸ”· 4. ä¸¾ä¾‹å¯¹æ¯”

### MVC ç¤ºä¾‹ï¼ˆReact ç±»ç»„ä»¶ + Reduxï¼‰ï¼š

* Modelï¼šRedux store
* Viewï¼šReact ç»„ä»¶ï¼ˆJSXï¼‰
* Controllerï¼šRedux Action + Reducer

å¼€å‘è€…éœ€æ‰‹åŠ¨æ´¾å‘ action â†’ æ›´æ–° store â†’ å†è§¦å‘ç»„ä»¶ re-renderã€‚

---

### MVVM ç¤ºä¾‹ï¼ˆVueï¼‰ï¼š

* Modelï¼šVue data é‡Œçš„æ•°æ®
* ViewModelï¼šVue å®ä¾‹ï¼Œå« `data`, `methods`, `computed`
* Viewï¼šæ¨¡æ¿ `<template>`ï¼Œè‡ªåŠ¨å’Œ data åŒå‘ç»‘å®š

Vue ä¼šè‡ªåŠ¨ç›‘å¬æ•°æ®å˜åŒ–å¹¶æ›´æ–° DOMï¼Œæ— éœ€å¼€å‘è€…æ‰‹åŠ¨æ“ä½œã€‚

---

## âœ… æ€»ç»“ï¼šMVC vs MVVM

| ç»´åº¦            | MVC                           | MVVM                   |
| ------------- | ----------------------------- | ---------------------- |
| æ•°æ®æµæ–¹å‘         | å•å‘                            | åŒå‘æ•°æ®ç»‘å®š                 |
| ç”¨æˆ·è¾“å…¥å¤„ç†        | Controller å¤„ç†                 | ViewModel å“åº”           |
| View æ˜¯å¦çŸ¥é“æ•°æ®æ¥æº | ä¸çŸ¥é“ï¼Œåªå±•ç¤º                       | æœ‰ä¸€å®šé€»è¾‘ï¼Œæ•°æ®å˜åŒ–è‡ªåŠ¨ç»‘å®š         |
| å¼€å‘è€…æ“ä½œ DOM     | è¾ƒå¤šï¼Œæ‰‹åŠ¨æ“ä½œ                       | å°‘ï¼Œæ¡†æ¶è´Ÿè´£                 |
| å¸¸ç”¨æ¡†æ¶          | åç«¯æ¡†æ¶å¦‚ Spring MVCï¼Œå‰ç«¯ React (ç±») | Vueã€Angularã€Knockout ç­‰ |

---




##  Element UI vue2 å¤šçº§å­ç»„ä»¶é€šä¿¡

åœ¨ Element UIï¼ˆåŸºäº Vue 2ï¼‰ä¸­ï¼Œç»„ä»¶ä¹‹é—´é€šä¿¡é™¤äº†å¸¸è§„çš„ propsã€$emitã€$refsã€provide/inject ç­‰æ–¹å¼ï¼Œè¿˜å†…ç½®äº†ä¸€ä¸ªç§æœ‰æ–¹æ³• broadcast ç”¨äº å¤šçº§å­ç»„ä»¶é€šä¿¡ï¼Œè¿™æ˜¯å…¶ç»„ä»¶é€šä¿¡æœºåˆ¶ä¸­æ¯”è¾ƒåº•å±‚ä½†å¸¸ç”¨çš„æŠ€å·§ã€‚

```js
function broadcast(componentName, eventName, params) {
  this.$children.forEach(child => {
    var name = child.$options.componentName;

    if (name === componentName) {
      child.$emit.apply(child, [eventName].concat(params));
    } else {
      broadcast.apply(child, [componentName, eventName].concat([params]));
    }
  });
}
export default {
  methods: {
    dispatch(componentName, eventName, params) {
      var parent = this.$parent || this.$root;
      var name = parent.$options.componentName;

      while (parent && (!name || name !== componentName)) {
        parent = parent.$parent;

        if (parent) {
          name = parent.$options.componentName;
        }
      }
      if (parent) {
        parent.$emit.apply(parent, [eventName].concat(params));
      }
    },
    broadcast(componentName, eventName, params) {
      broadcast.call(this, componentName, eventName, params);
    }
  }
};
```
## cookieå¸¸ç”¨çš„å±æ€§æœ‰å“ªäº›ï¼Ÿ
cookieå¸¸ç”¨çš„å±æ€§æœ‰ä»¥ä¸‹å‡ ç§ï¼š

| å±æ€§         | è¯´æ˜                                                       |
| ---------- | -------------------------------------------------------- |
| `expires`  | è¿‡æœŸæ—¶é—´ï¼ˆGMT æ ¼å¼ï¼‰                                             |
| `max-age`  | æœ‰æ•ˆæœŸï¼ˆç§’ï¼‰                                                   |
| `path`     | Cookie ç”Ÿæ•ˆè·¯å¾„ï¼Œé»˜è®¤æ˜¯å½“å‰è·¯å¾„                                      |
| `domain`   | Cookie ç”Ÿæ•ˆåŸŸåï¼ˆå­åŸŸå…±äº«æ—¶ä½¿ç”¨ï¼‰                                     |
| `secure`   | ä»…åœ¨ HTTPS ä¸‹ç”Ÿæ•ˆ                                             |
| `SameSite` | é˜²æ­¢ CSRFï¼š`Strict` / `Lax` / `None`ï¼ˆ`None` æ—¶å¿…é¡»é…åˆ `secure`ï¼‰ |

ç¬¬ä¸‰æ–¹åº“ js-cookie

Vue çš„è·¯ç”±å®ˆå«ï¼ˆNavigation Guardsï¼‰æ˜¯ Vue Router æä¾›çš„å¯¼èˆªé’©å­ï¼Œç”¨äºåœ¨**è·¯ç”±è·³è½¬å‰/å**æ‹¦æˆªæ§åˆ¶å¯¼èˆªè¡Œä¸ºã€‚ä½ å¯ä»¥åˆ©ç”¨å®ƒå®ç°ä¸€ç³»åˆ—æ ¸å¿ƒåŠŸèƒ½ï¼Œä¸»è¦åŒ…æ‹¬ï¼š

---

## âœ… è·¯ç”±å®ˆå«èƒ½åšä»€ä¹ˆï¼Ÿ

### 1. **æƒé™æ§åˆ¶ / ç™»å½•æ ¡éªŒ**

åœ¨ç”¨æˆ·æœªç™»å½•æˆ–æƒé™ä¸è¶³æ—¶ï¼Œé˜»æ­¢è¿›å…¥æŸäº›é¡µé¢ï¼Œå¹¶é‡å®šå‘ï¼š

```js
router.beforeEach((to, from, next) => {
  const isLoggedIn = !!localStorage.getItem('token');
  if (to.meta.requiresAuth && !isLoggedIn) {
    next('/login');
  } else {
    next();
  }
});
```

---

### 2. **é¡µé¢è·³è½¬å‰çš„ç¡®è®¤æç¤º**

ä¾‹å¦‚åœ¨ç¦»å¼€è¡¨å•é¡µé¢æ—¶æç¤ºç”¨æˆ·ä¿å­˜æ›´æ”¹ï¼š

```js
beforeRouteLeave(to, from, next) {
  if (this.isFormDirty) {
    const answer = window.confirm('ä½ è¿˜æœ‰æœªä¿å­˜çš„æ›´æ”¹ï¼Œç¡®å®šè¦ç¦»å¼€å—ï¼Ÿ');
    if (answer) {
      next();
    } else {
      next(false); // å–æ¶ˆå¯¼èˆª
    }
  } else {
    next();
  }
}
```

---

### 3. **è®¾ç½®é¡µé¢æ ‡é¢˜**

æ ¹æ®è·¯ç”±å…ƒä¿¡æ¯åŠ¨æ€ä¿®æ”¹ `<title>`ï¼š

```js
router.afterEach((to) => {
  document.title = to.meta.title || 'é»˜è®¤æ ‡é¢˜';
});
```

---

### 4. **è·¯ç”±çº§åˆ«çš„å¼‚æ­¥æ•°æ®åŠ è½½**

åœ¨è¿›å…¥é¡µé¢å‰è¯·æ±‚æ•°æ®ï¼Œç¡®ä¿é¡µé¢åŠ è½½æ—¶æ•°æ®å·²ç»å‡†å¤‡å¥½ï¼š

```js
router.beforeEach(async (to, from, next) => {
  if (to.name === 'user') {
    try {
      await store.dispatch('fetchUserData');
      next();
    } catch (e) {
      console.error(e);
      next(false);
    }
  } else {
    next();
  }
});
```

---

### 5. **é¡µé¢ç¼“å­˜æ§åˆ¶**

é…åˆ `keep-alive`ï¼Œé€šè¿‡ `meta` æ§åˆ¶å“ªäº›é¡µé¢éœ€è¦ç¼“å­˜ï¼š

```js
{
  path: '/detail',
  component: DetailPage,
  meta: { keepAlive: true }
}
```

ç„¶ååœ¨ `<keep-alive>` é‡Œåˆ¤æ–­ï¼š

```vue
<keep-alive include="DetailPage">
  <router-view />
</keep-alive>
```

---

## ğŸš¦ è·¯ç”±å®ˆå«ç±»å‹ä¸€è§ˆ

| ç±»å‹                  | ä½¿ç”¨ä½ç½®  | ç”¨é€”                  |
| ------------------- | ----- | ------------------- |
| `beforeEach`        | å…¨å±€    | æ‰€æœ‰è·³è½¬å‰æ‰§è¡Œ             |
| `beforeResolve`     | å…¨å±€    | æ‰€æœ‰ç»„ä»¶å†…å®ˆå«å’Œå¼‚æ­¥ç»„ä»¶åŠ è½½å®Œæˆåæ‰§è¡Œ |
| `afterEach`         | å…¨å±€    | æ‰€æœ‰è·³è½¬åæ‰§è¡Œï¼ˆæ— æ³•é˜»æ­¢è·³è½¬ï¼‰     |
| `beforeEnter`       | è·¯ç”±é…ç½®ä¸­ | ç‰¹å®šè·¯ç”±è·³è½¬å‰æ‰§è¡Œ           |
| `beforeRouteEnter`  | ç»„ä»¶å†…   | è¿›å…¥è¯¥ç»„ä»¶çš„è·¯ç”±ä¹‹å‰è°ƒç”¨        |
| `beforeRouteUpdate` | ç»„ä»¶å†…   | å½“å‰ç»„ä»¶å¤ç”¨æ—¶ï¼Œè·¯ç”±å‚æ•°å˜åŒ–æ—¶è°ƒç”¨   |
| `beforeRouteLeave`  | ç»„ä»¶å†…   | ç¦»å¼€å½“å‰ç»„ä»¶æ—¶è°ƒç”¨           |

---
## react é«˜é˜¶ç»„ä»¶
React çš„é«˜é˜¶ç»„ä»¶ï¼ˆ**Higher-Order Component**ï¼Œç®€ç§° **HOC**ï¼‰æ˜¯**ç”¨äºå¤ç”¨ç»„ä»¶é€»è¾‘çš„é«˜çº§æŠ€æœ¯**ã€‚

---

## ğŸ§  ä¸€å¥è¯å®šä¹‰

> é«˜é˜¶ç»„ä»¶æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¥æ”¶ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ª**å¢å¼ºåçš„æ–°ç»„ä»¶**ã€‚

```tsx
const EnhancedComponent = withSomething(OriginalComponent);
```

---

## ğŸ’¡ ä¸ºä»€ä¹ˆä½¿ç”¨ HOCï¼Ÿ

åœ¨ç»„ä»¶é—´å…±äº«é€»è¾‘ï¼ˆå¦‚æƒé™æ§åˆ¶ã€ç½‘ç»œè¯·æ±‚ã€ç”Ÿå‘½å‘¨æœŸæ—¥å¿—ï¼‰æ—¶ï¼Œ**ä¸ä¿®æ”¹åŸç»„ä»¶ä»£ç **ï¼Œé€šè¿‡åŒ…è£¹çš„æ–¹å¼å®ç°â€œåŠŸèƒ½å¢å¼ºâ€ã€‚

---

## ğŸ“¦ é«˜é˜¶ç»„ä»¶çš„åŸºæœ¬ç»“æ„

```tsx
function withLogger(WrappedComponent) {
  return function EnhancedComponent(props) {
    console.log('ç»„ä»¶æ¸²æŸ“ï¼Œpropsï¼š', props);
    return <WrappedComponent {...props} />;
  };
}
```

---

## ğŸ§ª ç¤ºä¾‹ï¼šå®ç°ä¸€ä¸ª `withAuth` é«˜é˜¶ç»„ä»¶ï¼ˆæ¨¡æ‹Ÿç™»å½•æƒé™æ‹¦æˆªï¼‰

### 1. åŸå§‹ç»„ä»¶

```tsx
function Dashboard() {
  return <h1>æ¬¢è¿æ¥åˆ°åå°ç®¡ç†ç³»ç»Ÿ</h1>;
}
```

### 2. HOC å®ç°

```tsx
import { Navigate } from 'react-router-dom';

function withAuth(WrappedComponent) {
  return function AuthComponent(props) {
    const isLogin = !!localStorage.getItem('token');

    if (!isLogin) {
      // å¦‚æœæœªç™»å½•ï¼Œé‡å®šå‘åˆ°ç™»å½•é¡µ
      return <Navigate to="/login" replace />;
    }

    // å·²ç™»å½•ï¼Œæ­£å¸¸æ¸²æŸ“ç»„ä»¶
    return <WrappedComponent {...props} />;
  };
}
```

### 3. ä½¿ç”¨ HOC åŒ…è£…åŸç»„ä»¶

```tsx
const ProtectedDashboard = withAuth(Dashboard);

// è·¯ç”±ä¸­ä½¿ç”¨
<Route path="/dashboard" element={<ProtectedDashboard />} />
```

---

## ğŸ§° å…¶ä»–å¸¸è§ç”¨é€”

| ç”¨é€”       | ç¤ºä¾‹è¯´æ˜                          |
| -------- | ----------------------------- |
| æƒé™æ§åˆ¶     | `withAuth(Component)`         |
| æ—¥å¿—æ”¶é›†     | `withLogger(Component)`       |
| ä¸»é¢˜æ³¨å…¥     | `withTheme(Component)`        |
| ç½‘ç»œè¯·æ±‚åŒ…è£…   | `withFetch(url)(Component)`   |
| è¡¨å•å¤„ç†é€»è¾‘å°è£… | `withFormHandling(Component)` |

---

## âš ï¸ æ³¨æ„äº‹é¡¹

* HOC ä¸ä¿®æ”¹åŸç»„ä»¶ï¼Œåªæ˜¯**åŒ…è£…äº†ä¸€å±‚**ã€‚
* HOC ä¸ä¼šæ‹¦æˆª `static` å±æ€§ï¼ˆå¯ä½¿ç”¨ `hoist-non-react-statics` å¤„ç†ï¼‰ã€‚
* å»ºè®®å‘½åä»¥ `withXXX` å¼€å¤´ã€‚

---

## âœ… å°ç»“

| æ¦‚å¿µ   | å†…å®¹                                  |
| ---- | ----------------------------------- |
| æ˜¯ä»€ä¹ˆ  | å‡½æ•°ï¼Œæ¥æ”¶ç»„ä»¶è¿”å›å¢å¼ºç»„ä»¶                       |
| ä½œç”¨   | å¤ç”¨é€»è¾‘ã€å¢å¼ºåŠŸèƒ½                           |
| ä½¿ç”¨æ–¹å¼ | `const Enhanced = withX(Component)` |
| æ›¿ä»£æ–¹æ¡ˆ | React Hooksï¼ˆä½† Hooks åªèƒ½åœ¨å‡½æ•°ç»„ä»¶å†…ä½¿ç”¨ï¼‰     |

---

React å¼•å…¥ **Hooks** çš„ä¸»è¦åŸå› æ˜¯ä¸ºäº†è§£å†³ç±»ç»„ä»¶çš„ä¸€äº›ç—›ç‚¹ï¼Œå¹¶è®©**å‡½æ•°ç»„ä»¶å…·å¤‡æ›´å¼ºçš„èƒ½åŠ›å’Œæ›´å¥½çš„å¼€å‘ä½“éªŒ**ã€‚ä¸‹é¢æˆ‘ä»¬è¯¦ç»†åˆ†æä¸€ä¸‹ä¸ºä»€ä¹ˆå¼•å…¥ Hooksï¼Œä»¥åŠå®ƒå’Œç±»ç»„ä»¶çš„å…³é”®åŒºåˆ«ã€‚

---

## ğŸ§© ä¸€ã€ä¸ºä»€ä¹ˆè¦å¼•å…¥ Hooksï¼Ÿ

### 1. **å¤ç”¨çŠ¶æ€é€»è¾‘å›°éš¾**

ç±»ç»„ä»¶é€šè¿‡ `HOC`ã€`render props` å®ç°é€»è¾‘å¤ç”¨ï¼Œä½†è¿™äº›æ–¹æ³•ä¼šå¯¼è‡´ï¼š

* åµŒå¥—åœ°ç‹±ï¼ˆWrapper Hellï¼‰ï¼›
* å‘½åå†²çªï¼›
* ä¸ç›´è§‚ã€ä¸æ˜“ç»´æŠ¤ã€‚

ğŸ‘‰ Hooks å¯ä»¥å°†**é€»è¾‘åˆ†ç¦»ä¸ºå‡½æ•°**ï¼ˆè‡ªå®šä¹‰ Hookï¼‰ï¼Œæ¸…æ™°å¤ç”¨ï¼Œæ— éœ€ç»„ä»¶åµŒå¥—ã€‚

---

### 2. **ç»„ä»¶ä¹‹é—´çŠ¶æ€é€»è¾‘åˆ†æ•£**

ç±»ç»„ä»¶ä¸­ï¼Œ**ç”Ÿå‘½å‘¨æœŸé’©å­ä¸èƒ½å¾ˆå¥½åœ°ç»„ç»‡ç›¸å…³é€»è¾‘**ã€‚ä¾‹å¦‚ï¼š

```js
componentDidMount() {
  // è·å–æ•°æ®
}
componentDidUpdate() {
  // å“åº”æŸä¸ª prop å˜åŒ–
}
componentWillUnmount() {
  // æ¸…é™¤å‰¯ä½œç”¨
}
```

ğŸ’¥ çŠ¶æ€é€»è¾‘è¢«åˆ†æ•£åœ¨å¤šä¸ªç”Ÿå‘½å‘¨æœŸä¸­ã€‚

ğŸ‘‰ ä½¿ç”¨ `useEffect()`ï¼Œå¯ä»¥å°†**ç›¸å…³å‰¯ä½œç”¨é€»è¾‘é›†ä¸­ç»„ç»‡**åœ¨ä¸€èµ·ã€‚

---

### 3. **this æŒ‡å‘é—®é¢˜ç¹ç**

ç±»ç»„ä»¶ä¸­ï¼Œ`this` çš„ç»‘å®šæ˜¯ä¸€ä¸ªå¸¸è§çš„å‘ï¼š

```js
this.handleClick = this.handleClick.bind(this);
```

ğŸ‘‰ Hooks æ²¡æœ‰ `this`ï¼Œç›´æ¥ä½¿ç”¨å‡½æ•°ä½œç”¨åŸŸï¼Œ**æ›´ç®€æ´ã€ç›´è§‚ã€æ—  this ç»‘å®šé—®é¢˜**ã€‚

---

### 4. **ç±»ç»„ä»¶éš¾ä»¥å‹ç¼©ä½“ç§¯å’Œåš tree-shaking**

å‡½æ•°ç»„ä»¶å¤©ç„¶æ›´è½»ä¾¿ï¼Œæ›´å®¹æ˜“è¢«å‹ç¼©å’Œä¼˜åŒ–ï¼Œé€‚åˆç°ä»£å‰ç«¯æ„å»ºå·¥å…·ã€‚

---

## âš–ï¸ äºŒã€Hooks ä¸ç±»ç»„ä»¶çš„åŒºåˆ«å¯¹æ¯”

| ç»´åº¦   | ç±»ç»„ä»¶                                      | å‡½æ•°ç»„ä»¶ + Hooks                           |
| ---- | ---------------------------------------- | -------------------------------------- |
| çŠ¶æ€ç®¡ç† | `this.state`, `setState`                 | `useState`, å¤šçŠ¶æ€å˜é‡                      |
| ç”Ÿå‘½å‘¨æœŸ | `componentDidMount` ç­‰                    | `useEffect`                            |
| é€»è¾‘å¤ç”¨ | HOC / render props                       | è‡ªå®šä¹‰ Hook                               |
| this | æœ‰ï¼Œéœ€è¦ç»‘å®š                                   | æ—                                       |
| ä½“ç§¯   | è¾ƒå¤§                                       | æ›´è½»                                     |
| ä»£ç ç»“æ„ | çŠ¶æ€é€»è¾‘åˆ†æ•£                                   | çŠ¶æ€é€»è¾‘é›†ä¸­                                 |
| æ€§èƒ½ä¼˜åŒ– | `shouldComponentUpdate`, `PureComponent` | `React.memo`, `useMemo`, `useCallback` |
| å†™æ³•   | OOP é¢å‘å¯¹è±¡                                 | å‡½æ•°å¼ç¼–ç¨‹                                  |

---

## âœ… ç¤ºä¾‹å¯¹æ¯”

### ğŸ‘´ ç±»ç»„ä»¶

```jsx
class Counter extends React.Component {
  state = { count: 0 }

  increment = () => {
    this.setState({ count: this.state.count + 1 })
  }

  render() {
    return <button onClick={this.increment}>{this.state.count}</button>
  }
}
```

### ğŸš€ å‡½æ•°ç»„ä»¶ + Hook

```jsx
function Counter() {
  const [count, setCount] = useState(0)
  return <button onClick={() => setCount(count + 1)}>{count}</button>
}
```

---

## ğŸ æ€»ç»“

| Hooks çš„ä»·å€¼ | æè¿°                   |
| --------- | -------------------- |
| æ›´å¥½å¤ç”¨é€»è¾‘    | è‡ªå®šä¹‰ Hook æ‹†åˆ†é€»è¾‘ï¼Œé¿å…åµŒå¥—åœ°ç‹± |
| æ›´å¥½ç»„ç»‡ä»£ç     | `useEffect` èšåˆå‰¯ä½œç”¨é€»è¾‘  |
| æ›´ç®€å•è¯­æ³•     | æ—  `this`ï¼Œæ›´å°‘ä»£ç         |
| æ›´å¼ºèƒ½åŠ›      | è®©å‡½æ•°ç»„ä»¶ä¹Ÿèƒ½ä½¿ç”¨çŠ¶æ€ã€å‰¯ä½œç”¨ç­‰èƒ½åŠ›   |
| æ›´ä½³æ€§èƒ½      | æ›´å®¹æ˜“ä¼˜åŒ–å’Œ Tree Shaking  |

---


## âœ… ç”¨ Hooks å¦‚ä½•å®ç°æƒé™æ§åˆ¶ï¼Ÿ

ä½ å¯ä»¥å€ŸåŠ© `useEffect` å’Œ `useNavigate` å®ç°â€œè®¿é—®å—é™æ—¶è·³è½¬â€ã€‚

### âœ… ç¤ºä¾‹ï¼šä½¿ç”¨ Hook çš„å†™æ³•

```jsx
// hooks/useAuthGuard.js
import { useEffect } from 'react';
import { useNavigate } from 'react-router-dom';

export function useAuthGuard(authenticated) {
  const navigate = useNavigate();

  useEffect(() => {
    if (!authenticated) {
      navigate('/login'); // æœªç™»å½•ï¼Œè·³è½¬ç™»å½•é¡µ
    }
  }, [authenticated, navigate]);
}
```

---

### âœ… é¡µé¢ç»„ä»¶ä¸­ä½¿ç”¨

```jsx
import { useAuthGuard } from './hooks/useAuthGuard';
import { useSelector } from 'react-redux'; // æˆ–ä½ è‡ªå·±çš„çŠ¶æ€ç®¡ç†é€»è¾‘

function Dashboard() {
  const isLogin = useSelector(state => state.user.isLogin);

  useAuthGuard(isLogin); // åŠ å…¥å®ˆå«

  return <div>Welcome to Dashboard</div>;
}
```

---

### âœ… è·¯ç”±ä¸­ç›´æ¥ä½¿ç”¨

```jsx
<Route path="/dashboard" element={<Dashboard />} />
```

---

## âœ… Hooks vs HOC åŒºåˆ«å¯¹æ¯”

| å¯¹æ¯”ç»´åº¦  | Hooks å®ç°                           | HOC å®ç°         |
| ----- | ---------------------------------- | -------------- |
| ä»£ç ç»„ç»‡  | æ›´é è¿‘ç»„ä»¶é€»è¾‘ï¼Œçµæ´»                         | æå‰åŒ…è£…ç»„ä»¶ï¼Œå°è£…é€»è¾‘æ¸…æ™°  |
| é€»è¾‘å¤ç”¨  | å‡½æ•°æŠ½å‡º Hook æ›´è‡ªç„¶                      | å°è£… HOCï¼Œé€»è¾‘å¤ç”¨ä¹Ÿå¯ä»¥ |
| å¯è¯»æ€§   | æ›´ç›´è§‚ï¼Œæ— åµŒå¥—å±‚çº§                          | æŠ½è±¡çº§åˆ«é«˜ï¼Œä¸æ˜“ç†è§£     |
| è·¯ç”±çµæ´»æ€§ | ç»„ä»¶å†…éƒ¨å¤„ç†ï¼Œæ­é…çŠ¶æ€ç®¡ç†çµæ´»è·³è½¬                  | åŒ…è£¹ç»„ä»¶å¹¶æ§åˆ¶è¾“å‡º      |
| æ¨èç¨‹åº¦  | âœ… æ¨èï¼ˆå‡½æ•°ç»„ä»¶é…åˆ useEffect/useNavigateï¼‰ | ğŸŸ¡ é€‚ç”¨äºå¤æ‚æŠ½è±¡å°è£…   |

---

## ğŸ§© æç¤º

ä½ ä¹Ÿå¯ä»¥å°†æƒé™è·¯ç”±ç»Ÿä¸€å°è£…æˆä¸€ä¸ª `PrivateRoute` ç»„ä»¶ï¼Œæ›´æ¸…æ™°ï¼š

```jsx
function PrivateRoute({ children }) {
  const isLogin = useSelector(state => state.user.isLogin);
  return isLogin ? children : <Navigate to="/login" />;
}

// ä½¿ç”¨æ–¹å¼ï¼š
<Route path="/dashboard" element={
  <PrivateRoute><Dashboard /></PrivateRoute>
} />
```

---

