import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as e,e as a,o as n}from"./app-DkVa7Hgi.js";const l={};function r(t,i){return n(),e("div",null,i[0]||(i[0]=[a(`<h1 id="serverservice" tabindex="-1"><a class="header-anchor" href="#serverservice"><span>ServerService</span></a></h1><p><strong>按模块、按作用、按流程</strong> 把这个 <code>ServerService</code> 文件讲得非常清晰，让你一眼就知道：<br><strong>这个文件是什么、负责什么、为什么这样写、整个逻辑怎么走。</strong></p><hr><h1 id="serverservice-ts-—-干啥的-一句话总结" tabindex="-1"><a class="header-anchor" href="#serverservice-ts-—-干啥的-一句话总结"><span><strong>ServerService.ts — 干啥的？一句话总结</strong></span></a></h1><blockquote><p><strong>ServerService 是课程播放器（ICW Player）中负责 “从服务器获取课件数据 / 构建课件数据 / 处理预览数据” 的核心服务。</strong></p></blockquote><p>它做的事包括：</p><ul><li>向后台请求课件 manifest（云端版本）</li><li>获取草稿数据（editor 草稿）</li><li>根据 uuid/code/file 三种不同来源组装课件</li><li>管理进度（progress）</li><li>构建文件上传版课件（本地文件 preview）</li><li>加载/补充 slides</li><li>统一 axios 请求、错误处理</li><li>初始化 UI 状态</li></ul><p>是 <strong>播放器启动流程中最核心的数据初始化模块</strong>。</p><hr><h1 id="整体结构图-超清晰" tabindex="-1"><a class="header-anchor" href="#整体结构图-超清晰"><span><strong>整体结构图（超清晰）</strong></span></a></h1><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>┌──────────────────────────┐</span></span>
<span class="line"><span>│        ServerService     │</span></span>
<span class="line"><span>├──────────────────────────┤</span></span>
<span class="line"><span>│ axios instance           │</span></span>
<span class="line"><span>│ config                   │</span></span>
<span class="line"><span>│ data(CwTaskData)         │</span></span>
<span class="line"><span>│ progress                 │</span></span>
<span class="line"><span>├──────────────────────────┤</span></span>
<span class="line"><span>│ createDraft()            │  ← 草稿预览入口</span></span>
<span class="line"><span>│ init()                   │  ← 核心初始化逻辑（入口）</span></span>
<span class="line"><span>│ queryCwTaskDataJson()    │  ← 通过 code 请求转换结果</span></span>
<span class="line"><span>│ queryCwVersionJson()     │  ← 通过 uuid 请求 manifest.json</span></span>
<span class="line"><span>│ getDraftData()           │  ← 编辑器草稿接口</span></span>
<span class="line"><span>│ sendSubmitQuestion()     │  ← 用户答题接口</span></span>
<span class="line"><span>│ addThumbnailPrefix()     │  ← 修正 slide 缩略图地址</span></span>
<span class="line"><span>└──────────────────────────┘</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h1 id="详细说明-每个部分在干什么" tabindex="-1"><a class="header-anchor" href="#详细说明-每个部分在干什么"><span><strong>详细说明：每个部分在干什么</strong></span></a></h1><hr><h1 id="_1-依赖注入-tsyringe" tabindex="-1"><a class="header-anchor" href="#_1-依赖注入-tsyringe"><span>1. <strong>依赖注入 (tsyringe)</strong></span></a></h1><div class="language-ts line-numbers-mode" data-highlighter="shiki" data-ext="ts" data-title="ts" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">singleton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">ServerService</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">injectable</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">ServerService</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>说明：</p><ul><li>这是 <strong>单例服务</strong>，整个播放器只有一个 ServerService。</li><li>被 container 管理，随时 <code>container.resolve(ServerService)</code> 获取实例。</li></ul><hr><h1 id="_2-axios-实例初始化-拦截器" tabindex="-1"><a class="header-anchor" href="#_2-axios-实例初始化-拦截器"><span>2. <strong>axios 实例初始化 + 拦截器</strong></span></a></h1><p>构造函数：</p><div class="language-ts line-numbers-mode" data-highlighter="shiki" data-ext="ts" data-title="ts" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">this</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">instance</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> axios</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">create</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">timeout</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 60000</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> })</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>作用：</p><ul><li>统一所有请求的基础配置</li><li>设置超时</li><li>设置统一错误输出</li></ul><hr><p>响应拦截器逻辑：</p><ul><li>如果 <code>response.status === 200</code>，正常返回</li><li>否则写 error log</li><li>error 时向外抛 <code>{ message, url }</code>，不是直接抛 axios 原始错误</li></ul><p><strong>这样播放器日志可以更清晰定位错误来源。</strong></p><hr><h1 id="_3-createdraft-uuid-code" tabindex="-1"><a class="header-anchor" href="#_3-createdraft-uuid-code"><span>3. <strong>createDraft(uuid, code)</strong></span></a></h1><p>这个是 <strong>编辑器草稿模式预览</strong> 的入口。</p><p>作用：</p><ul><li>获取草稿数据（slides）</li><li>构造 data.progress</li><li>标记当前 step 为 <code>&quot;GeneratingPreview&quot;</code></li></ul><p>是为「实时预览」准备的。</p><hr><h1 id="_4-init-config-traceid-最核心方法" tabindex="-1"><a class="header-anchor" href="#_4-init-config-traceid-最核心方法"><span>4. <strong>init(config, traceID)</strong>（<em><strong>最核心方法</strong></em>）</span></a></h1><p>这是播放器真正启动时调用的入口。</p><p>流程：</p><h3 id="_1-保存-config" tabindex="-1"><a class="header-anchor" href="#_1-保存-config"><span><strong>(1) 保存 config</strong></span></a></h3><div class="language-ts line-numbers-mode" data-highlighter="shiki" data-ext="ts" data-title="ts" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">this</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">config</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> config</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_2-改-ui-状态-→-loading" tabindex="-1"><a class="header-anchor" href="#_2-改-ui-状态-→-loading"><span><strong>(2) 改 UI 状态 → loading</strong></span></a></h3><p>依赖 AppService：</p><div class="language-ts line-numbers-mode" data-highlighter="shiki" data-ext="ts" data-title="ts" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">appService</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">changeUIStatus</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">PageStatus</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">loading</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;boot server&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_3-判断课件入口方式" tabindex="-1"><a class="header-anchor" href="#_3-判断课件入口方式"><span><strong>(3) 判断课件入口方式</strong></span></a></h3><p>有 3 种来源：</p><h3 id="_1-uuid-模式-云端课件" tabindex="-1"><a class="header-anchor" href="#_1-uuid-模式-云端课件"><span><strong>① uuid 模式（云端课件）</strong></span></a></h3><div class="language-ts line-numbers-mode" data-highlighter="shiki" data-ext="ts" data-title="ts" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">uuid</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">  versionData</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> await</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> this</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">queryCwVersionJson</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">uuid</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>从 CDN 获取：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>/icw/{uuid}/manifest.json</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>解析课件 metadata + slides。</p><h3 id="_2-scene-preview-草稿预览" tabindex="-1"><a class="header-anchor" href="#_2-scene-preview-草稿预览"><span><strong>② scene = preview（草稿预览）</strong></span></a></h3><div class="language-ts line-numbers-mode" data-highlighter="shiki" data-ext="ts" data-title="ts" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">scene</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;preview&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>调用草稿接口：</p><div class="language-ts line-numbers-mode" data-highlighter="shiki" data-ext="ts" data-title="ts" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">await</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> this</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getDraftData</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_3-file-模式-本地文件预览" tabindex="-1"><a class="header-anchor" href="#_3-file-模式-本地文件预览"><span><strong>③ file 模式（本地文件预览）</strong></span></a></h3><div class="language-ts line-numbers-mode" data-highlighter="shiki" data-ext="ts" data-title="ts" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>流程：</p><ul><li>读取文件</li><li>createPageJsonFromFiles</li><li>gzip slide.json</li><li>构造单页课件</li></ul><p>用于上传文件预览课件。</p><h3 id="_4-code-模式-接口转换结果" tabindex="-1"><a class="header-anchor" href="#_4-code-模式-接口转换结果"><span><strong>④ code 模式（接口转换结果）</strong></span></a></h3><p>请求接口：</p><div class="language-ts line-numbers-mode" data-highlighter="shiki" data-ext="ts" data-title="ts" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">queryCwTaskDataJson</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>通过 code 去 LMS 转换服务器读取转换结果。</p><hr><h1 id="_5-addthumbnailprefix-slides" tabindex="-1"><a class="header-anchor" href="#_5-addthumbnailprefix-slides"><span>5. <strong>addThumbnailPrefix(slides)</strong></span></a></h1><p>统一每页 slide 的缩略图：</p><ul><li>如果 slide 有 thumbnailUrl → 加 THUMBNAIL_SUFFIX</li><li>否则 → 设置默认 icon</li></ul><hr><h1 id="_6-querycwtaskdatajson" tabindex="-1"><a class="header-anchor" href="#_6-querycwtaskdatajson"><span>6. <strong>queryCwTaskDataJson()</strong></span></a></h1><p>通过 <strong>code</strong> 从 LMS 拉课件转换结果：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>GET /lms/resource/conversion/{code}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>这是 AS 体系课件转换后的结构：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>{</span></span>
<span class="line"><span>  success: boolean</span></span>
<span class="line"><span>  data: {</span></span>
<span class="line"><span>    jsonString: {...} ← 核心课件数据</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h1 id="_7-querycwversionjson-uuid" tabindex="-1"><a class="header-anchor" href="#_7-querycwversionjson-uuid"><span>7. <strong>queryCwVersionJson(uuid)</strong></span></a></h1><p>通过 CDN 拉 manifest.json：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>/icw/{uuid}/manifest.json</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>逻辑包含：</p><ul><li>主 CDN 请求失败 → 使用 backup CDN 再请求一次</li><li>两次都失败 → 抛 Error</li></ul><p>错误日志非常完整。</p><hr><h1 id="_8-getdraftdata" tabindex="-1"><a class="header-anchor" href="#_8-getdraftdata"><span>8. <strong>getDraftData()</strong></span></a></h1><p>编辑器使用：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>/api/editor/v1/icw/material/draft/list</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>拉草稿列表。</p><hr><h1 id="_9-sendsubmitquestion" tabindex="-1"><a class="header-anchor" href="#_9-sendsubmitquestion"><span>9. <strong>sendSubmitQuestion()</strong></span></a></h1><p>用户答题结果上传：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>POST /user/answer/add</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>携带 token 和 header。</p><hr><h1 id="_10-总结-这个文件的定位" tabindex="-1"><a class="header-anchor" href="#_10-总结-这个文件的定位"><span><strong>10. 总结：这个文件的定位</strong></span></a></h1><blockquote><p><strong>ServerService 是 ICW 播放器的数据中心，统一管理所有课件数据的来源、解析、错误处理、进度构造，是整个播放器启动流程的核心组件之一。</strong></p></blockquote><p>它负责：</p><h3 id="✔-拉课件" tabindex="-1"><a class="header-anchor" href="#✔-拉课件"><span>✔ 拉课件</span></a></h3><h3 id="✔-构造课件结构" tabindex="-1"><a class="header-anchor" href="#✔-构造课件结构"><span>✔ 构造课件结构</span></a></h3><h3 id="✔-文件预览" tabindex="-1"><a class="header-anchor" href="#✔-文件预览"><span>✔ 文件预览</span></a></h3><h3 id="✔-云端课件拉取" tabindex="-1"><a class="header-anchor" href="#✔-云端课件拉取"><span>✔ 云端课件拉取</span></a></h3><h3 id="✔-草稿课件预览" tabindex="-1"><a class="header-anchor" href="#✔-草稿课件预览"><span>✔ 草稿课件预览</span></a></h3><h3 id="✔-补充-slide-信息" tabindex="-1"><a class="header-anchor" href="#✔-补充-slide-信息"><span>✔ 补充 slide 信息</span></a></h3><h3 id="✔-请求出错时自动降级到-backup" tabindex="-1"><a class="header-anchor" href="#✔-请求出错时自动降级到-backup"><span>✔ 请求出错时自动降级到 backup</span></a></h3><h3 id="✔-上报问题-答题" tabindex="-1"><a class="header-anchor" href="#✔-上报问题-答题"><span>✔ 上报问题（答题）</span></a></h3><h3 id="✔-和-ui-层联动" tabindex="-1"><a class="header-anchor" href="#✔-和-ui-层联动"><span>✔ 和 UI 层联动</span></a></h3><p><strong>整套逻辑非常工程化、健壮。</strong></p><hr><p>如果你需要，我还可以帮你：</p><h3 id="✅-画一张-serverservice-初始化完整流程图" tabindex="-1"><a class="header-anchor" href="#✅-画一张-serverservice-初始化完整流程图"><span>✅ 画一张 ServerService 初始化完整流程图</span></a></h3><h3 id="✅-按-给同事讲解-的风格写文档" tabindex="-1"><a class="header-anchor" href="#✅-按-给同事讲解-的风格写文档"><span>✅ 按“给同事讲解”的风格写文档</span></a></h3><h3 id="✅-按你的代码库风格写注释版源码" tabindex="-1"><a class="header-anchor" href="#✅-按你的代码库风格写注释版源码"><span>✅ 按你的代码库风格写注释版源码</span></a></h3><h3 id="✅-拆解成架构图-代码图-数据流图" tabindex="-1"><a class="header-anchor" href="#✅-拆解成架构图-代码图-数据流图"><span>✅ 拆解成架构图 + 代码图 + 数据流图</span></a></h3><p>你想要哪种？</p>`,111)]))}const p=s(l,[["render",r]]),c=JSON.parse('{"path":"/posts/%E7%9F%A5%E8%AF%86%E9%9B%86%E9%94%A6/cocos%20%E5%B7%A5%E7%A8%8B%E6%9E%84%E5%BB%BA/player/ServerService.html","title":"ServerService","lang":"zh-CN","frontmatter":{"description":"ServerService 按模块、按作用、按流程 把这个 ServerService 文件讲得非常清晰，让你一眼就知道： 这个文件是什么、负责什么、为什么这样写、整个逻辑怎么走。 ServerService.ts — 干啥的？一句话总结 ServerService 是课程播放器（ICW Player）中负责 “从服务器获取课件数据 / 构建课件数据 ...","head":[["meta",{"property":"og:url","content":"https://mister-hope.github.io/zy-vuepress/posts/%E7%9F%A5%E8%AF%86%E9%9B%86%E9%94%A6/cocos%20%E5%B7%A5%E7%A8%8B%E6%9E%84%E5%BB%BA/player/ServerService.html"}],["meta",{"property":"og:site_name","content":"我的基地"}],["meta",{"property":"og:title","content":"ServerService"}],["meta",{"property":"og:description","content":"ServerService 按模块、按作用、按流程 把这个 ServerService 文件讲得非常清晰，让你一眼就知道： 这个文件是什么、负责什么、为什么这样写、整个逻辑怎么走。 ServerService.ts — 干啥的？一句话总结 ServerService 是课程播放器（ICW Player）中负责 “从服务器获取课件数据 / 构建课件数据 ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-11-25T09:19:17.000Z"}],["meta",{"property":"article:modified_time","content":"2025-11-25T09:19:17.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"ServerService\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-11-25T09:19:17.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Mrs.Zoe\\",\\"url\\":\\"https://mister-hope.com\\"}]}"]]},"headers":[{"level":3,"title":"(1) 保存 config","slug":"_1-保存-config","link":"#_1-保存-config","children":[]},{"level":3,"title":"(2) 改 UI 状态 → loading","slug":"_2-改-ui-状态-→-loading","link":"#_2-改-ui-状态-→-loading","children":[]},{"level":3,"title":"(3) 判断课件入口方式","slug":"_3-判断课件入口方式","link":"#_3-判断课件入口方式","children":[]},{"level":3,"title":"① uuid 模式（云端课件）","slug":"_1-uuid-模式-云端课件","link":"#_1-uuid-模式-云端课件","children":[]},{"level":3,"title":"② scene = preview（草稿预览）","slug":"_2-scene-preview-草稿预览","link":"#_2-scene-preview-草稿预览","children":[]},{"level":3,"title":"③ file 模式（本地文件预览）","slug":"_3-file-模式-本地文件预览","link":"#_3-file-模式-本地文件预览","children":[]},{"level":3,"title":"④ code 模式（接口转换结果）","slug":"_4-code-模式-接口转换结果","link":"#_4-code-模式-接口转换结果","children":[]},{"level":3,"title":"✔ 拉课件","slug":"✔-拉课件","link":"#✔-拉课件","children":[]},{"level":3,"title":"✔ 构造课件结构","slug":"✔-构造课件结构","link":"#✔-构造课件结构","children":[]},{"level":3,"title":"✔ 文件预览","slug":"✔-文件预览","link":"#✔-文件预览","children":[]},{"level":3,"title":"✔ 云端课件拉取","slug":"✔-云端课件拉取","link":"#✔-云端课件拉取","children":[]},{"level":3,"title":"✔ 草稿课件预览","slug":"✔-草稿课件预览","link":"#✔-草稿课件预览","children":[]},{"level":3,"title":"✔ 补充 slide 信息","slug":"✔-补充-slide-信息","link":"#✔-补充-slide-信息","children":[]},{"level":3,"title":"✔ 请求出错时自动降级到 backup","slug":"✔-请求出错时自动降级到-backup","link":"#✔-请求出错时自动降级到-backup","children":[]},{"level":3,"title":"✔ 上报问题（答题）","slug":"✔-上报问题-答题","link":"#✔-上报问题-答题","children":[]},{"level":3,"title":"✔ 和 UI 层联动","slug":"✔-和-ui-层联动","link":"#✔-和-ui-层联动","children":[]},{"level":3,"title":"✅ 画一张 ServerService 初始化完整流程图","slug":"✅-画一张-serverservice-初始化完整流程图","link":"#✅-画一张-serverservice-初始化完整流程图","children":[]},{"level":3,"title":"✅ 按“给同事讲解”的风格写文档","slug":"✅-按-给同事讲解-的风格写文档","link":"#✅-按-给同事讲解-的风格写文档","children":[]},{"level":3,"title":"✅ 按你的代码库风格写注释版源码","slug":"✅-按你的代码库风格写注释版源码","link":"#✅-按你的代码库风格写注释版源码","children":[]},{"level":3,"title":"✅ 拆解成架构图 + 代码图 + 数据流图","slug":"✅-拆解成架构图-代码图-数据流图","link":"#✅-拆解成架构图-代码图-数据流图","children":[]}],"git":{"createdTime":1764062357000,"updatedTime":1764062357000,"contributors":[{"name":"zouyu","username":"zouyu","email":"891374900@qq.com","commits":1,"url":"https://github.com/zouyu"}]},"readingTime":{"minutes":3.29,"words":988},"filePathRelative":"posts/知识集锦/cocos 工程构建/player/ServerService.md","localizedDate":"2025年11月25日","excerpt":"\\n<p><strong>按模块、按作用、按流程</strong> 把这个 <code>ServerService</code> 文件讲得非常清晰，让你一眼就知道：<br>\\n<strong>这个文件是什么、负责什么、为什么这样写、整个逻辑怎么走。</strong></p>\\n<hr>\\n<h1><strong>ServerService.ts — 干啥的？一句话总结</strong></h1>\\n<blockquote>\\n<p><strong>ServerService 是课程播放器（ICW Player）中负责 “从服务器获取课件数据 / 构建课件数据 / 处理预览数据” 的核心服务。</strong></p>\\n</blockquote>","autoDesc":true}');export{p as comp,c as data};
